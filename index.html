
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>ğŸ§± Trivo Store</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .error { color: red; }
    .success { color: green; }
    .producto { margin-bottom: 15px; padding: 10px; border: 1px solid #ccc; border-radius: 6px; background: #f5f5f5; }
    .diagnostico { font-size: 0.9em; margin-top: 10px; padding: 10px; background: #f1f1f1; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body>

<h1><span style="color: purple;">ğŸ§± Trivo Store</span></h1>

<div id="estado-conexion">ğŸŒ Verificando conexiÃ³n...</div>

<h2>ğŸ Productos Disponibles</h2>
<div id="productos">ğŸ“¦ Cargando productos...</div>

<h3>ğŸ” Panel Privado (ContraseÃ±a: trivo2025)</h3>
<input type="password" id="clave" placeholder="Introduce la contraseÃ±a">
<button onclick="entrarPrivado()">â Entrar</button>

<div id="panel-privado" style="display:none; margin-top: 20px;">
  <h3>ğŸ‘‘ Bienvenido al Panel Privado</h3>
  <p>ğŸ“‹ AquÃ­ irÃ¡ tu panel de administraciÃ³n.</p>
</div>

<h3>ğŸ“Š DiagnÃ³stico TÃ©cnico:</h3>
<div class="diagnostico" id="diagnostico">ğŸ§ª Iniciando diagnÃ³stico...</div>

<script>
  // ğŸ”Œ ConexiÃ³n Supabase
  const supabaseUrl = 'https://uzqmsbkjontizhovxajx.supabase.co';
  const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV6cW1zYmtqb250aXpob3h2YWp4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgzMDY1NjYsImV4cCI6MjA2Mzg4MjU2Nn0.RtiBzB0k0qzFzsfgUZcIvW1eyu2VmVbEolCWQDkDwbU';
  const supabase = supabase.createClient(supabaseUrl, supabaseKey);

  const productosDiv = document.getElementById("productos");
  const diagnosticoDiv = document.getElementById("diagnostico");

  async function verificarConexion() {
    try {
      const { data, error } = await supabase.from('mercancilla').select('*').limit(1);
      if (error) throw error;
      document.getElementById("estado-conexion").innerHTML = "âœ… Conectado correctamente a Supabase.";
      diagnosticoDiv.innerHTML += "<br>âœ… ConexiÃ³n verificada correctamente.";
    } catch (e) {
      document.getElementById("estado-conexion").innerHTML = "âŒ Error al conectar.";
      diagnosticoDiv.innerHTML += "<br>âŒ Error de conexiÃ³n: " + e.message;
    }
  }

  async function mostrarProductos() {
    try {
      const { data, error } = await supabase.from('mercancilla').select('*');
      if (error) throw error;

      productosDiv.innerHTML = "";
      data.forEach(prod => {
        const div = document.createElement("div");
        div.className = "producto";
        div.innerHTML = `
          <strong>${prod.nombre}</strong><br>
          ğŸ“ ${prod.descripcion}<br>
          ğŸ’µ Precio: $${prod.precio}<br>
          ğŸ·ï¸ CategorÃ­a: ${prod.categoria}<br>
          ğŸ–¼ï¸ <img src="${prod.imagen_url}" alt="${prod.nombre}" width="150">
        `;
        productosDiv.appendChild(div);
      });

      diagnosticoDiv.innerHTML += `<br>âœ… Se cargaron ${data.length} productos correctamente.`;
    } catch (e) {
      productosDiv.innerHTML = "âŒ Error al cargar productos.";
      diagnosticoDiv.innerHTML += "<br>âŒ Error inesperado: " + e.message;
    }
  }

  function entrarPrivado() {
    const clave = document.getElementById("clave").value;
    if (clave === "trivo2025") {
      document.getElementById("panel-privado").style.display = "block";
    } else {
      alert("âŒ ContraseÃ±a incorrecta");
    }
  }

  // â–¶ï¸ Ejecutar funciones al cargar
  verificarConexion().then(() => console.log("âœ… VerificaciÃ³n de conexiÃ³n ejecutada."));
  mostrarProductos().then(() => console.log("âœ… Mostrar productos ejecutada."));
</script>

</body>
</html>
